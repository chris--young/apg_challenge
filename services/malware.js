/**
 * /services/malware.js
 *
 * @description: Malware service layer
 * @author: Chris Young (young.c.5690@gmail.com)
 * @created: September 17th 2015
 */

let knex = require('knex');

let database = knex({
  client: 'mysql',
  connection: {
    host: '127.0.0.1',
    user: process.env.APG_USER,
    password: process.env.APG_PASS,
    database: 'apg_challenge'
  }
});

/**
 * Malware.create()
 * @description: Creates a new malware entry in the database
 */
exports.create = (data, callback) => {
  database('malware').insert(data).then((data) => {
    return callback(null, data);
  }).catch((error) => {
    return callback(500, 'Failed to enter malware into database');
  });
};

/**
 * Malware.read()
 * @description: Fetches all malware entries from the database
 */
exports.read = (callback) => {
  database.select().table('malware').then((data) => {
    return callback(null, data);
  }).catch((error) => {
    return callback(500, 'Failed to read malware from database');
  });
};

